



# 05 åŸºäºBP_Adaboostçš„å¼ºåˆ†ç±»/é¢„æµ‹å™¨è®¾è®¡

## 1 æ¡ˆä¾‹èƒŒæ™¯ï¼šå…¬å¸è´¢åŠ¡é¢„è­¦ç³»ç»Ÿï¼ˆåˆ†ç±»å™¨ï¼‰

### 1.1 è¾“å…¥è¾“å‡º

è¾“å…¥æ•°æ®ï¼š10ç»´ï¼Œåˆ†åˆ«ä»£è¡¨å…¬å¸çš„åä¸ªæŒ‡æ ‡ï¼š

- æˆåˆ†è´¹ç”¨åˆ©æ¶¦ç‡
- èµ„äº§è¥è¿èƒ½åŠ›
- å…¬å¸æ€»èµ„äº§
- æ€»èµ„äº§å¢é•¿ç‡
- æµåŠ¨æ¯”ç‡
- è¥ä¸šç°é‡‘æµé‡
- å®¡è®¡æ„è§ç±»å‹
- æ¯è‚¡æ”¶ç›Š
- å­˜è´§å‘¨è½¬ç‡
- èµ„äº§è´Ÿå€ºç‡

è¾“å‡ºï¼š1ç»´ï¼Œè¡¨ç¤ºå…¬å¸çš„è´¢åŠ¡æƒ…å†µï¼š

- ä¸º1è¡¨ç¤ºè´¢åŠ¡çŠ¶å†µè‰¯å¥½
- ä¸º-1è¡¨ç¤ºè´¢åŠ¡çŠ¶å†µå‡ºç°é—®é¢˜

### 1.2 æ•°æ®é›†ä¸­æ•°æ®åˆ†é…

1000ç»„æ•°æ®ä½œä¸ºè¾“å…¥æ•°æ®ï¼Œ350ç»„æ•°æ®ä½œä¸ºæµ‹è¯•æ•°æ®ã€‚

æ ¹æ®æ•°æ®ç»´æ•°ï¼Œé‡‡ç”¨çš„BPç¥ç»ç½‘ç»œç»“æ„ä¸º10-6-1ï¼Œå…±è®­ç»ƒç”Ÿæˆ10ä¸ª BPç¥ç»ç½‘ç»œå¼±åˆ†ç±»å™¨ï¼Œæœ€åç”¨10ä¸ªå¼±åˆ†ç±»å™¨ç»„æˆå¼ºåˆ†ç±»å™¨å¯¹å…¬å¸è´¢åŠ¡çŠ¶å†µè¿›è¡Œåˆ†ç±»ã€‚

### 1.3 æ³¨ï¼šæµ‹è¯•å™¨ä½¿ç”¨çš„æ¡ˆä¾‹æ˜¯é¢„æµ‹å‡½æ•° $y = x_1^2 + x_2 ^2$ çš„å€¼



## 2 Adaboostæ¨¡å‹ç®€ä»‹

ç®—æ³•æ€æƒ³ï¼š**åˆå¹¶å¤šä¸ªâ€œå¼±â€åˆ†ç±»å™¨çš„è¾“å‡ºä»¥äº§ç”Ÿæœ‰æ•ˆåˆ†ç±»**

é¦–å…ˆç»™å‡ºå¼±å­¦ä¹ ç®—æ³•å’Œæ ·æœ¬ç©ºé—´(ğ‘‹,ğ‘Œ)ï¼Œä»æ ·æœ¬ç©ºé—´ä¸­æ‰¾å‡ºğ‘šç»„è®­ç»ƒæ•°æ®ï¼Œæ¯ç»„è®­ç»ƒæ•°æ®çš„æƒé‡éƒ½æ˜¯$\frac{1}{m}$ã€‚

ç„¶åç”¨å¼±å­¦ä¹ ç®—æ³•è¿­ä»£è¿ç®—ğ‘‡æ¬¡ï¼Œæ¯æ¬¡è¿ç®—åéƒ½æŒ‰ç…§åˆ†ç±»ç»“æœæ›´æ–°è®­ç»ƒæ•°æ®æƒé‡åˆ†å¸ƒã€‚

- åˆ†ç±»å™¨ï¼šå¯¹äº  **åˆ†ç±»å¤±è´¥çš„è®­ç»ƒä¸ªä½“**  èµ‹äºˆè¾ƒå¤§æƒé‡ï¼Œä¸‹æ¬¡è¿­ä»£è¿ç®—æ—¶æ›´åŠ å…³æ³¨è¿™äº›è®­ç»ƒä¸ªä½“ã€‚

- æµ‹è¯•å™¨ï¼šå¯¹äº  **é¢„æµ‹è¯¯å·®è¶…è¿‡é˜ˆå€¼ä¸ªä½“**  èµ‹äºˆè¾ƒå¤§æƒé‡ï¼Œä¸‹æ¬¡è¿­ä»£è¿ç®—æ—¶æ›´åŠ å…³æ³¨è¿™äº›è®­ç»ƒä¸ªä½“ã€‚

å¼±åˆ†ç±»å™¨é€šè¿‡åå¤è¿­ä»£å¾—åˆ°ä¸€ä¸ªåˆ†ç±»å‡½æ•°åºåˆ—ï¼Œ$f_1,f_2, Â·Â·Â·f_T$

æ¯ä¸ªåˆ†ç±»å‡½æ•°èµ‹äºˆä¸€ä¸ªæƒé‡ï¼Œåˆ†ç±»ç»“æœè¶Šå¥½çš„å‡½æ•°ï¼Œå…¶å¯¹åº”æƒé‡è¶Šå¤§ã€‚

ğ‘‡æ¬¡è¿­ä»£ä¹‹åï¼Œæœ€ç»ˆå¼ºåˆ†ç±»å‡½æ•°ğ¹ç”±å¼±åˆ†ç±»å‡½æ•°åŠ æƒå¾—åˆ°ã€‚



## 3 BP_Adabooståˆ†ç±»å™¨æ¨¡å‹

BP_Adaboostæ¨¡å‹å³BPç¥ç»ç½‘ç»œä½œä¸ºå¼±åˆ†ç±»å™¨ï¼Œåå¤è®­ç»ƒBPç¥ç»ç½‘ç»œé¢„æµ‹æ ·æœ¬è¾“å‡ºï¼Œé€šè¿‡Adaboostç®—æ³•å¾—åˆ°å¤šä¸ªBPç¥ç»ç½‘ç»œå¼±åˆ†ç±»å™¨ç»„æˆçš„å¼ºåˆ†ç±»å™¨ã€‚

![](https://img2018.cnblogs.com/i-beta/1752446/202002/1752446-20200220094843893-896865310.png)

### 3.1 æ•°æ®åˆå§‹åŒ–

- åˆ†ç±»å™¨ï¼šä»æ ·æœ¬ç©ºé—´ä¸­éšæœºé€‰æ‹©ğ‘šç»„è®­ç»ƒæ•°æ®ï¼Œåˆå§‹åŒ–æµ‹è¯•æ•°æ®çš„åˆ†å¸ƒæƒå€¼ï¼š${D_t}(i) = \frac{1}{m}$

å› ä¸ºè®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®å·²ç»åˆ†å¥½äº†ï¼Œæ‰€ä»¥åªéœ€è¦åˆå§‹åŒ–æƒé‡å³å¯

```matlab
%% ä¸‹è½½æ•°æ®
load data input_train output_train input_test output_test

%% æƒé‡åˆå§‹åŒ–
[mm,nn]=size(input_train);
D(1,:)=ones(1,nn)/nn;
```

- æµ‹è¯•å™¨ï¼š

å…ˆæ‰“ä¹±æ ·æœ¬é¡ºåºï¼Œéšæœºåˆ†å‡º1900ä¸ªæµ‹è¯•æ•°æ®å’Œ100ä¸ªè®­ç»ƒæ•°æ®ï¼Œå†åˆå§‹åŒ–æƒé‡ã€‚

```matlab
%% ä¸‹è½½æ•°æ®
load data1 input output

%æ‰“ä¹±æ ·æœ¬çš„é¡ºåº
k=rand(1,2000);
[m,n]=sort(k);

%è®­ç»ƒæ ·æœ¬
input_train=input(n(1:1900),:)';
output_train=output(n(1:1900),:)';

%æµ‹è¯•æ ·æœ¬
input_test=input(n(1901:2000),:)';
output_test=output(n(1901:2000),:)';
```

åˆå§‹åŒ–æƒé‡ï¼š

```matlab
%æƒé‡åˆå§‹åŒ–
[mm,nn]=size(input_train);
D(1,:)=ones(1,nn)/nn;
```

### 3.2 ç½‘ç»œåˆå§‹åŒ–

- åˆ†ç±»å™¨ï¼šæ ¹æ®æ ·æœ¬è¾“å…¥è¾“å‡ºç»´æ•°ç¡®å®šç¥ç»ç½‘ç»œç»“æ„ï¼Œåˆå§‹åŒ–BPç¥ç»ç½‘ç»œæƒå€¼å’Œé˜ˆå€¼ã€‚

```matlab
%% å¼±åˆ†ç±»å™¨åˆ†ç±»
K=10;
for i=1:K
    
    %è®­ç»ƒæ ·æœ¬å½’ä¸€åŒ–
    [inputn,inputps]=mapminmax(input_train);
    [outputn,outputps]=mapminmax(output_train);
    error(i)=0;
    
    %BPç¥ç»ç½‘ç»œæ„å»º
    net=newff(inputn,outputn,6);
    net.trainParam.epochs=5;
    net.trainParam.lr=0.1;
    net.trainParam.goal=0.00004;
    
    %BPç¥ç»ç½‘ç»œè®­ç»ƒ
    net=train(net,inputn,outputn);
    
    %è®­ç»ƒæ•°æ®é¢„æµ‹
    an1=sim(net,inputn);
    test_simu1(i,:)=mapminmax('reverse',an1,outputps);
    
    %æµ‹è¯•æ•°æ®é¢„æµ‹
    inputn_test =mapminmax('apply',input_test,inputps);
    an=sim(net,inputn_test);
    test_simu(i,:)=mapminmax('reverse',an,outputps);
    
    %ç»Ÿè®¡è¾“å‡ºæ•ˆæœ
    kk1=find(test_simu1(i,:)>0);
    kk2=find(test_simu1(i,:)<0);
```

- æµ‹è¯•å™¨ï¼š

```matlab
%è®­ç»ƒæ ·æœ¬å½’ä¸€åŒ–
[inputn,inputps]=mapminmax(input_train);
[outputn,outputps]=mapminmax(output_train);

K=10;
for i=1:K
    
    %å¼±é¢„æµ‹å™¨è®­ç»ƒ
    net=newff(inputn,outputn,5);
    net.trainParam.epochs=20;
    net.trainParam.lr=0.1;
    net=train(net,inputn,outputn);
    
    %å¼±é¢„æµ‹å™¨é¢„æµ‹
    an1=sim(net,inputn);
    BPoutput=mapminmax('reverse',an1,outputps);
    
    %é¢„æµ‹è¯¯å·®
    erroryc(i,:)=output_train-BPoutput;
    
    %æµ‹è¯•æ•°æ®é¢„æµ‹
    inputn1=mapminmax('apply',input_test,inputps);
    an2=sim(net,inputn1);
    test_simu(i,:)=mapminmax('reverse',an2,outputps);
```



### 3.3 å¼±åˆ†ç±»å™¨é¢„æµ‹

è®­ç»ƒç¬¬ğ‘¡ä¸ªå¼±åˆ†ç±»å™¨æ—¶ï¼Œç”¨è®­ç»ƒæ•°æ®è®­ç»ƒBPç¥ç»ç½‘ç»œå¹¶ä¸”é¢„æµ‹è®­ç»ƒæ•°æ®è¾“å‡ºï¼Œå¾—åˆ°é¢„æµ‹åºåˆ—ğ‘”(ğ‘¡)çš„é¢„æµ‹è¯¯å·®$e_t$.

$$
{e_t} = \sum\limits_i {{D_t}(i)} \;\;\;i = 1,2, \ldots ,m(g(t) \ne y)
$$

- åˆ†ç±»å™¨

```matlab
   aa(kk1)=1;
    aa(kk2)=-1;
    
    %ç»Ÿè®¡é”™è¯¯æ ·æœ¬æ•°
    for j=1:nn
        if aa(j)~=output_train(j);
            error(i)=error(i)+D(i,j);
        end
    end
```

- æµ‹è¯•å™¨ï¼šæ²¡æœ‰è¿™ä¸€æ­¥

### 2.3 è®¡ç®—é¢„æµ‹åºåˆ—æƒé‡

- åˆ†ç±»å™¨ï¼š

æ ¹æ®é¢„æµ‹åºåˆ—ğ‘”(ğ‘¡)çš„é¢„æµ‹è¯¯å·®$e_t$è®¡ç®—åºåˆ—çš„æƒé‡$a_t$ï¼Œæƒé‡è®¡ç®—å…¬å¼ä¸º
$$
{a_t} = \frac{1}{2}\ln \left( {\frac{{1 - {e_t}}}{{{e_t}}}} \right)
$$

```matlab
    %å¼±åˆ†ç±»å™¨iæƒé‡
    at(i)=0.5*log((1-error(i))/error(i));
```

- æµ‹è¯•å™¨ï¼š

$$
a_t = \frac{0.5}{e^{|e_t|}}
$$

```matlab
    %è®¡ç®—å¼±é¢„æµ‹å™¨iæƒé‡
    at(i)=0.5/exp(abs(Error(i)));
```



### 3.4 æµ‹è¯•æ•°æ®æƒé‡è°ƒæ•´

æ ¹æ®é¢„æµ‹åºåˆ—æƒé‡$a_t$æŒ‘ä¸­ä¸‹ä¸€è½®è®­ç»ƒæ ·æœ¬çš„æƒé‡ï¼Œè°ƒæ•´å…¬å¼ä¸º
$$
{D_{t + 1}}(i) = \frac{{{D_t}(i)}}{{{B_t}}} \cdot {e^{ - {a_t}{y_i}{g_t}({x_i})}}\;\;\;i = 1,2, \ldots ,m
$$
å…¶ä¸­ï¼Œ$B_t$ä¸ºå½’ä¸€åŒ–å› å­ï¼Œç›®çš„æ˜¯åœ¨æƒé‡æ¯”ä¾‹ä¸å˜çš„æƒ…å†µä¸‹ä½¿åˆ†å¸ƒæƒå€¼å’Œä¸º1ã€‚

- åˆ†ç±»å™¨ï¼š

```matlab
    %æ›´æ–°Då€¼
    for j=1:nn
        D(i+1,j)=D(i,j)*exp(-at(i)*aa(j)*test_simu1(i,j));
    end
    %Då€¼å½’ä¸€åŒ–
    Dsum=sum(D(i+1,:));
    D(i+1,:)=D(i+1,:)/Dsum;    
end
```

- æµ‹è¯•å™¨ï¼š

```matlab
    %è°ƒæ•´Då€¼
    Error(i)=0;
    for j=1:nn
        if abs(erroryc(i,j))>0.2  %è¾ƒå¤§è¯¯å·®
            Error(i)=Error(i)+D(i,j);
            D(i+1,j)=D(i,j)*1.1;
        else
            D(i+1,j)=D(i,j);
        end
    end
    
    %Då€¼å½’ä¸€åŒ–
    D(i+1,:)=D(i+1,:)/sum(D(i+1,:));
end
```

### 3.5 å¼ºåˆ†ç±»å‡½æ•°

- åˆ†ç±»å™¨ï¼š

è®­ç»ƒğ‘‡è½®åå¾—åˆ°ğ‘‡ç»„å¼±åˆ†ç±»å‡½æ•°$f(g_{t},a_{t})$ï¼Œç”±ğ‘‡ç»„å¼±åˆ†ç±»å‡½æ•°ç»„åˆå¾—åˆ°äº†å¼ºåˆ†ç±»å‡½æ•°
$$
h(x) = {\rm{sign}}[\sum\limits_{t = 1}^T {{a_t} \cdot f({g_t},{a_t})} ]
$$

```matlab
%% å¼ºåˆ†ç±»å™¨åˆ†ç±»ç»“æœ
output=sign(at*test_simu);
```

- æµ‹è¯•å™¨ï¼šç›´æ¥æ€»å’Œâ—ä¸ªæ•°

```matlab
at=at/sum(at);
```



## 4 åˆ†ç±»ç»“æœç»Ÿè®¡

- åˆ†ç±»å™¨ï¼š

ç»Ÿè®¡å¼ºåˆ†ç±»å™¨æ¯ç±»åˆ†ç±»ï¼ˆå…±æœ‰ **è‰¯å¥½kkk1/å‡ºç°é—®é¢˜kkk2** ä¸¤ç±»ï¼‰é”™è¯¯ä¸ªæ•°

```matlab
kkk1=0;
kkk2=0;
for j=1:350
    if output(j)==1
        if output(j)~=output_test(j)
            kkk1=kkk1+1;
        end
    end
    if output(j)==-1
        if output(j)~=output_test(j)
            kkk2=kkk2+1;
        end
    end
end
```



- æµ‹è¯•å™¨ï¼š

```matlab
%å¼ºåˆ†ç¦»å™¨æ•ˆæœ
output=at*test_simu;
error=output_test-output;
plot(abs(error),'-*')
hold on
for i=1:8
error1(i,:)=test_simu(i,:)-output;
end
plot(mean(abs(error1)),'-or')

title('å¼ºé¢„æµ‹å™¨é¢„æµ‹è¯¯å·®ç»å¯¹å€¼','fontsize',12)
xlabel('é¢„æµ‹æ ·æœ¬','fontsize',12)
ylabel('è¯¯å·®ç»å¯¹å€¼','fontsize',12)
legend('å¼ºé¢„æµ‹å™¨é¢„æµ‹','å¼±é¢„æµ‹å™¨é¢„æµ‹')
```

<img src="/Users/xixixiao/Desktop/study/MatlabLearning/code/05- åŸºäºBP_Adaboostçš„å¼ºåˆ†ç±»å™¨è®¾è®¡/fore_output.png" alt="fore_output" style="zoom:48%;" />

